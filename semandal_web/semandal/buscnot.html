<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"> 
<head> 
<title>XHTML Example Page</title> 

<style>
#submit {
    background-color: black;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius:6px;
    color: white;
    font-family: 'Oswald';
    font-size: 20px;
    text-decoration: none;
    cursor: pointer;
    border:none;
}



#submit:hover {
    border: none;
    background: black;
	color: #adff2f;
    box-shadow: 0px 0px 1px #777;
}<
</style>
<script type="text/javascript"> 
    function updatephp(){
        var j = document.getElementById('titular');
        var titular = j.value;
        var k = document.getElementById('fechai');
        var fecha_i = k.value;
        var n = document.getElementById('fechaf');
        var fecha_f = n.value;
        var l = document.getElementById('idc');
        var cat = l.value;
        var m = document.getElementById('idp');
        var pob = m.value;
        var u = document.getElementById('idu');
        var idu = u.value;        
        var rin = document.getElementById('ri');
        var ri = rin.value;        
        var rfn = document.getElementById('rf');
        var rf = rfn.value;        
        var stringfinal="";


        if (titular !== ""){
            stringfinal = stringfinal+"_t:"+titular+",";
        }
        if (fecha_i !== "" && fecha_f ===""){
            stringfinal = stringfinal+"_d:"+fecha_i+":"+fecha_i+",";
        }
        if (fecha_i === "" && fecha_f !==""){
            stringfinal = stringfinal+"_d:"+fecha_f+":"+fecha_f+",";
        }
        if (fecha_i !== "" && fecha_f !==""){
            stringfinal = stringfinal+"_d:"+fecha_i+":"+fecha_f+",";
        }
        if (cat !== ""){
            stringfinal = stringfinal+"_c:"+cat+",";
        }
        if (pob !== ""){
            stringfinal = stringfinal+"_p:"+pob+",";
        }
        if (ri===""){
        	ri="0";
        }
        if(rf===""){
        	rf="10";
        }
        if(idu===""){
        	idu="0";
        }



        if (stringfinal !== ""){
        stringfinal = stringfinal.substring(0,stringfinal.length-1)
        }

        var newurl = 'http://95.39.221.207:8000/api/busqueda/('+stringfinal+')'+'/'+ri+'/'+rf+'/'+idu;
        var xhr = new XMLHttpRequest();
        var k = xhr.open('get', 'prueba.php?uno='+newurl);
        xhr.onreadystatechange = function(){
        // Ready state 4 means the request is done
        if(xhr.readyState === 4){
            // 200 is a successful return
            if(xhr.status === 200){
              document.getElementById('actualizar').innerHTML=xhr.responseText;
              document.getElementById('ipllamada').innerHTML=newurl;
              // alert(xhr.responseText); // 'This is the returned text.'
            }else{
                alert('Error: '+xhr.status); // An error occurred during the request
            }
        }
    }
     xhr.send(null);
    }
</script>
</head> 

<body>
<p>
GET METHOD
</p>
<p>
Devuelve una noticia según los datos de búsqueda que le pasemos por parámetros. También nos dice si, dado un usuario, la noticia ha sido ya vista.
</p>
<p>
El formato de la fecha debe ser DD-MM-AAAA (los 0 a la izquierda son opcionales.)
</p>

<p>
ESTRUCTURA DEVUELTA
</p>

{
<ul name = "tipos" style="list-style: none;">
  <li>ret:"boolean",</li>
  <li>resultado:[</li>
<ul name = "tipos" style="list-style: none;">
    {
      <li>id_noticia:"integer",</li>
      <li>titular:"string",</li>
      <li>fecha:"string",</li>
      <li>url:"string",</li>
      <li>liked:"integer",</li>
      <li>dspueblo:"string",</li>
      <li>ncomentarios:"integer",</li>
      <li>categoria:[</li>
      <ul name = "tipos" style="list-style: none;">
      {
        <li>id_categoria:"integer",</li>
        <li>dscategoria:"string"</li>
      }
      </ul>
      ],
      <li>vista:"boolean"</li>
</ul>
}

<p>
<form name ="subscribe" id="subscribe_frm" action="#">

titular: <input id="titular" idtype="text" name="titular" autofocus required />
</p>
<p>

fecha inicio: <input id="fechai" idtype="text" name="fechai" autofocus required />
</p>

<p>

fecha fin: <input id="fechaf" idtype="text" name="fechaf" autofocus required />
</p>
<p>

id_categoria: <input id="idc" idtype="text" name="id_c" autofocus required />
</p>
<p>

id_pueblo: <input id="idp" idtype="text" name="id_p" autofocus required />

</p>

rango inicio: <input id="ri" idtype="text" name="ri" autofocus required />
</p>


</p>

rango final: <input id="rf" idtype="text" name="rf" autofocus required />
</p>
</p>

id_usuario: <input id="idu" idtype="text" name="idu" autofocus required />
</p>

<input type="button" name="submit" value="Pruébalo!" id="submit" onclick="updatephp()"/>
</form>
</p>
<div id ="ipllamada"></div>
<p>
</p>
<div id ="actualizar"></div>
</body> 
</meta>
</html>